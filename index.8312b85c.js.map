{"mappings":"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","sources":["src/index.js","src/js/markup.js"],"sourcesContent":["import { fetchApi, fetchGenre, fetchFilmById, fetchSearch, fetchFilmsCol } from './js/fetchApi';\nimport { creatMarkup, creatCardMarkup } from './js/markup';\n\nconst GENERS_LOCAL = 'genres';\nconst WATCHED_LOCAL = 'watched';\nconst QUEUE_LOCAL = 'queque';\n\n\nconst filmListRef = document.querySelector('.film-list');\nconst backdropRef = document.querySelector('.backdrop');\nconst closeModalBtn = document.querySelector('.modal-close__btn');\nconst modalBoxRef = document.querySelector('.modal-box');\nconst searchFormRef = document.querySelector('.header-form');\nconst searchFormText = document.querySelector('.header-form__text');\nconst modalBtnsRef = document.querySelectorAll('.modal-btn');\nconst modalBtnWatchedRef = document.querySelector('button[data-watched]');\nconst modalBtnQueueRef = document.querySelector('button[data-queue]');\n\nsearchFormText.style.visibility = 'hidden';\n\nsearchFormRef.addEventListener('submit', onSearch);\nfilmListRef.addEventListener('click', openModal);\ncloseModalBtn.addEventListener('click', closeModal);\nmodalBtnQueueRef.addEventListener('click', addQueue);\nmodalBtnWatchedRef.addEventListener('click', addWatched);\n\nbackdropRef.addEventListener('click', (evt) => {\n    if (evt.target.className === 'backdrop') {\n        backdropRef.classList.add('is-hidden');\n    }\n});\n\nfetchGenre()\n    .then(data => {\n        const genres = JSON.stringify(data.genres);\n        localStorage.setItem(GENERS_LOCAL, genres);\n    }).catch(err => console.log(err));\n\nfetchApi().then(data => {\n    const items = data.results;\n    const markup = creatMarkup(items);\n    filmListRef.insertAdjacentHTML('beforeend', markup);\n    \n}).catch(err => console.log(err))\n\nfunction addQueue(evt) {\n    const id = Number(evt.target.dataset.id);\n    const arr = JSON.parse(localStorage.getItem(QUEUE_LOCAL));\n    \n    if(!arr) {\n        const arr2 = [];\n        arr2.push(id);\n        localStorage.setItem(QUEUE_LOCAL, JSON.stringify(arr2));\n        closeModal();\n        return\n    }\n    if (!arr.includes(id)) {\n        arr.push(id);\n        localStorage.setItem(QUEUE_LOCAL, JSON.stringify(arr));\n        closeModal();\n        return;\n    }\n    closeModal();\n}\n\nfunction addWatched(evt) {\n    const id = Number(evt.target.dataset.id);\n    const arr = JSON.parse(localStorage.getItem(WATCHED_LOCAL));\n    \n    if(!arr) {\n        const arr2 = [];\n        arr2.push(id);\n        localStorage.setItem(WATCHED_LOCAL, JSON.stringify(arr2));\n        closeModal();\n        return\n    }\n    if (!arr.includes(id)) {\n        arr.push(id);\n        localStorage.setItem(WATCHED_LOCAL, JSON.stringify(arr));\n        closeModal();\n        return;\n    }\n    closeModal();\n}\n\nfunction openModal(evt) {\n    window.addEventListener('keydown', closeModalEsc)\n    const filmId = Number(evt.target.dataset.id);\n\n    if (!filmId) {\n        return;\n    }\n    backdropRef.classList.remove('is-hidden')\n\n    modalBtnsRef.forEach((item) => {\n        item.setAttribute('data-id', filmId)\n    });\n\n    fetchFilmById(filmId).then(data => {\n        const markup = creatCardMarkup(data);\n        modalBoxRef.innerHTML = markup;\n    })\n\n} \n\nfunction closeModal() {\n    backdropRef.classList.add('is-hidden');\n    modalBtnsRef.forEach((item) => {\n        item.removeAttribute('data-id');\n    });\n    window.removeEventListener('keydown', closeModalEsc);\n}\n\nfunction closeModalEsc(evt) {\n    console.log(evt.code);\n    if (evt.code === \"Escape\") {\n        closeModal();\n    }\n}\n\nfunction onSearch(evt) {\n    evt.preventDefault();\n    searchFormText.style.visibility = 'hidden';\n    const serchFilm = evt.currentTarget.elements.searchFilm.value;\n    \n    \n    fetchSearch(serchFilm).then(data => {\n        const items = data.results;\n        if (!items[0]) {\n            searchFormText.style.visibility = 'visible';\n            return\n        }\n\n        filmListRef.innerHTML = '';\n        const markup = creatMarkup(items);\n        filmListRef.insertAdjacentHTML('beforeend', markup);\n    }).catch(console.log);\n}\n\n","export { creatMarkup, creatCardMarkup };\n\nfunction creatMarkup(items) {\n    const elements = items.filter(el => el.backdrop_path);\n    \n    const markup = elements.map(({ title, release_date, poster_path, id }) => {\n        return `\n        <li class=\"film-list__item\">\n          <img src=\"https://image.tmdb.org/t/p/w500${poster_path}\" alt=\"${title}\" class=\"film-list__img\" data-id=\"${id}\">\n          <h2 class=\"film-list__title\">${title}</h2>\n          <p class=\"film-list__text\">${release_date}</p>\n        </li>\n        `}).join('');\n    return markup;\n}\n\nfunction creatCardMarkup({ overview, popularity, poster_path, original_title, vote_average, vote_count, release_date}) {\n    const markup = `\n        <img src=\"https://image.tmdb.org/t/p/w500${poster_path}\" class=\"modal-img\" alt=\"${original_title}\" loading=\"lazy\">\n        <div class=\"modal-content-box\">\n            <h2 class=\"modal-title\">${original_title}</h2>\n\n            <ul class=\"modal-list\">\n                <li class=\"modal-list__item\">\n                    <p class=\"modal-list__text\">Vote / Votes</p>\n                    <span class=\"modal-list__vote\">${vote_average}</span>\n                    <span class=\"modal-list__value\">${vote_count}</span>\n                </li>\n\n                <li class=\"modal-list__item\">\n                    <p class=\"modal-list__text\">Popularity</p>\n                    <span class=\"modal-list__value\">${popularity}</span>\n                </li>\n\n                <li class=\"modal-list__item\">\n                    <p class=\"modal-list__text\">Original Title</p>\n                    <span class=\"modal-list__value\">${original_title}</span>\n                </li>\n\n                <li class=\"modal-list__item\">\n                    <p class=\"modal-list__text\">Release date</p>\n                    <span class=\"modal-list__value\">${release_date}</span>\n                </li>\n            </ul>\n            <h3 class=\"modal-sub-title\">About</h3>\n            <p class=\"modal-text\">${overview}</p>\n        </div>\n    `;\n    return markup;\n}"],"names":["$sRYpV","parcelRequire","$1457a8b41868a85b$export$d15b2e48a080e0fe","items","filter","el","backdrop_path","map","param","title","release_date","poster_path","id","concat","join","$b8f9b7833fa37166$var$WATCHED_LOCAL","$b8f9b7833fa37166$var$QUEUE_LOCAL","$b8f9b7833fa37166$var$filmListRef","document","querySelector","$b8f9b7833fa37166$var$backdropRef","$b8f9b7833fa37166$var$closeModalBtn","$b8f9b7833fa37166$var$modalBoxRef","$b8f9b7833fa37166$var$searchFormRef","$b8f9b7833fa37166$var$searchFormText","$b8f9b7833fa37166$var$modalBtnsRef","querySelectorAll","$b8f9b7833fa37166$var$modalBtnWatchedRef","$b8f9b7833fa37166$var$modalBtnQueueRef","$b8f9b7833fa37166$var$closeModal","classList","add","forEach","item","removeAttribute","window","removeEventListener","$b8f9b7833fa37166$var$closeModalEsc","evt","console","log","code","style","visibility","addEventListener","preventDefault","serchFilm","currentTarget","elements","searchFilm","value","fetchSearch","then","data","results","innerHTML","markup","insertAdjacentHTML","catch","filmId","Number","target","dataset","remove","setAttribute","fetchFilmById","overview","popularity","original_title","vote_average","vote_count","arr","JSON","parse","localStorage","getItem","arr2","push","setItem","stringify","includes","className","fetchGenre","genres","err","fetchApi"],"version":3,"file":"index.8312b85c.js.map"}